var t,s,e=(t,s,e)=>(((t,s,e)=>{if(!s.has(t))throw TypeError("Cannot "+e)})(t,s,"access private method"),e);import{J as i,K as a,O as o,L as n,M as r,N as l,P as h,Q as c,R as p,T as m,U as u,V as d,W as f,X as g,Y as y,Z as k,l as w,_ as C,$ as b,a0 as T,o as $,c as S,w as x,E as v,q as A,x as _,e as P,a1 as E,a2 as D,a as O,j as I,G as B}from"./index-95803fb6.js";const j=t=>(s,e=a())=>{!m&&i(t,s,e)},M=j(o),X=j(n),Y=j(r),N=j(l),z=j(h),H=j(c);const L=t=>{let s;try{const e=d(t);s=function(t){let s=!1;try{JSON.parse(t),s=!0}catch(e){s=!1}return s}(e)?JSON.parse(e):e}catch(e){}return console.log("key: "+t+" data: "+s),s},W="token",R=10,J=t=>{g({title:t,icon:"none"})};let Z={platform:"android",apikey:"android",version:"3.1.1"};y({invoke:t=>{const s=q().getToken().toString();s&&(Z={...Z,token:s}),t.header=Z},returnValue:t=>{},success:t=>{switch(t.statusCode){case 401:q().removeToken(),J("登录失效");break;case 200:let s=t.data;0!==s.code&&J(s.message)}},fail:t=>{console.log("fail: "+JSON.stringify(t))}});t=new WeakSet,s=function(t){return new Promise(((s,e)=>{k({...t,url:`https://cim-test-api.yidejia.com/${t.path}`,timeout:1e4,success:t=>{if(200===t.statusCode){const i=t.data;0===i.code?s(i.data):e(i.message)}else e(t.errMsg)},fail:t=>{e(t)}})}))};const V=new class{constructor(){((t,s,e)=>{if(s.has(t))throw TypeError("Cannot add the same private member more than once");s instanceof WeakSet?s.add(t):s.set(t,e)})(this,t)}get(i,a={}){return e(this,t,s).call(this,{...a,method:"GET",path:i})}post(i,a={}){return e(this,t,s).call(this,{...a,method:"POST",path:i})}},U=()=>V.get("mall/staff_purchase/activity"),G=()=>V.get("mall/staff_purchase/activity/category"),K=(t,s,e=1)=>V.get(`mall/staff_purchase/activity/goods/${t}`,{data:{page:e,per_page:10,cate_id:s}}),q=w("main",{state:()=>({token:"",staffEntrance:[],staffInfo:{}}),actions:{setToken(t){this.token=t,((t,s)=>{try{u(t,s instanceof Object?JSON.stringify(s):s)}catch(e){}})(W,t)},removeToken(){this.token="",(t=>{try{f(t)}catch(s){}})(W)},getToken(){return this.token?this.token:L(W)},async initData(){this.staffEntrance=await V.get("mall/staff/entrance"),this.staffInfo=await V.get("mall/staff/info")},changeOAAccount:async t=>await(t=>V.post("mall/staff/chose_account",{data:{staff_id:t}}))(t)}});class F{constructor(t,s){this.options=t,this.animation=C({...t}),this.currentStepAnimates={},this.next=0,this.$=s}_nvuePushAnimates(t,s){let e=this.currentStepAnimates[this.next],i={};if(i=e||{styles:{},config:{}},Q.includes(t)){i.styles.transform||(i.styles.transform="");let e="";"rotate"===t&&(e="deg"),i.styles.transform+=`${t}(${s+e}) `}else i.styles[t]=`${s}`;this.currentStepAnimates[this.next]=i}_animateRun(t={},s={}){let e=this.$.$refs.ani.ref;if(e)return new Promise(((i,a)=>{nvueAnimation.transition(e,{styles:t,...s},(t=>{i()}))}))}_nvueNextAnimate(t,s=0,e){let i=t[s];if(i){let{styles:a,config:o}=i;this._animateRun(a,o).then((()=>{s+=1,this._nvueNextAnimate(t,s,e)}))}else this.currentStepAnimates={},"function"==typeof e&&e(),this.isEnd=!0}step(t={}){return this.animation.step(t),this}run(t){this.$.animationData=this.animation.export(),this.$.timer=setTimeout((()=>{"function"==typeof t&&t()}),this.$.durationTime)}}const Q=["matrix","matrix3d","rotate","rotate3d","rotateX","rotateY","rotateZ","scale","scale3d","scaleX","scaleY","scaleZ","skew","skewX","skewY","translate","translate3d","translateX","translateY","translateZ"];function tt(t,s){if(s)return clearTimeout(s.timer),new F(t,s)}Q.concat(["opacity","backgroundColor"],["width","height","left","right","top","bottom"]).forEach((t=>{F.prototype[t]=function(...s){return this.animation[t](...s),this}}));const st=(t,s)=>{const e=t.__vccOpts||t;for(const[i,a]of s)e[i]=a;return e};const et=st({name:"uniTransition",emits:["click","change"],props:{show:{type:Boolean,default:!1},modeClass:{type:[Array,String],default:()=>"fade"},duration:{type:Number,default:300},styles:{type:Object,default:()=>({})},customClass:{type:String,default:""},onceRender:{type:Boolean,default:!1}},data:()=>({isShow:!1,transform:"",opacity:1,animationData:{},durationTime:300,config:{}}),watch:{show:{handler(t){t?this.open():this.isShow&&this.close()},immediate:!0}},computed:{stylesObject(){let t={...this.styles,"transition-duration":this.duration/1e3+"s"},s="";for(let e in t){s+=this.toLine(e)+":"+t[e]+";"}return s},transformStyles(){return"transform:"+this.transform+";opacity:"+this.opacity+";"+this.stylesObject}},created(){this.config={duration:this.duration,timingFunction:"ease",transformOrigin:"50% 50%",delay:0},this.durationTime=this.duration},methods:{init(t={}){t.duration&&(this.durationTime=t.duration),this.animation=tt(Object.assign(this.config,t),this)},onClick(){this.$emit("click",{detail:this.isShow})},step(t,s={}){if(this.animation){for(let s in t)try{"object"==typeof t[s]?this.animation[s](...t[s]):this.animation[s](t[s])}catch(e){console.error(`方法 ${s} 不存在`)}return this.animation.step(s),this}},run(t){this.animation&&this.animation.run(t)},open(){clearTimeout(this.timer),this.transform="",this.isShow=!0;let{opacity:t,transform:s}=this.styleInit(!1);void 0!==t&&(this.opacity=t),this.transform=s,this.$nextTick((()=>{this.timer=setTimeout((()=>{this.animation=tt(this.config,this),this.tranfromInit(!1).step(),this.animation.run(),this.$emit("change",{detail:this.isShow})}),20)}))},close(t){this.animation&&this.tranfromInit(!0).step().run((()=>{this.isShow=!1,this.animationData=null,this.animation=null;let{opacity:t,transform:s}=this.styleInit(!1);this.opacity=t||1,this.transform=s,this.$emit("change",{detail:this.isShow})}))},styleInit(t){let s={transform:""},e=(t,e)=>{"fade"===e?s.opacity=this.animationType(t)[e]:s.transform+=this.animationType(t)[e]+" "};return"string"==typeof this.modeClass?e(t,this.modeClass):this.modeClass.forEach((s=>{e(t,s)})),s},tranfromInit(t){let s=(t,s)=>{let e=null;"fade"===s?e=t?0:1:(e=t?"-100%":"0","zoom-in"===s&&(e=t?.8:1),"zoom-out"===s&&(e=t?1.2:1),"slide-right"===s&&(e=t?"100%":"0"),"slide-bottom"===s&&(e=t?"100%":"0")),this.animation[this.animationMode()[s]](e)};return"string"==typeof this.modeClass?s(t,this.modeClass):this.modeClass.forEach((e=>{s(t,e)})),this.animation},animationType:t=>({fade:t?1:0,"slide-top":`translateY(${t?"0":"-100%"})`,"slide-right":`translateX(${t?"0":"100%"})`,"slide-bottom":`translateY(${t?"0":"100%"})`,"slide-left":`translateX(${t?"0":"-100%"})`,"zoom-in":`scaleX(${t?1:.8}) scaleY(${t?1:.8})`,"zoom-out":`scaleX(${t?1:1.2}) scaleY(${t?1:1.2})`}),animationMode:()=>({fade:"opacity","slide-top":"translateY","slide-right":"translateX","slide-bottom":"translateY","slide-left":"translateX","zoom-in":"scale","zoom-out":"scale"}),toLine:t=>t.replace(/([A-Z])/g,"-$1").toLowerCase()}},[["render",function(t,s,e,i,a,o){const n=P;return b(($(),S(n,{ref:"ani",animation:a.animationData,class:A(e.customClass),style:_(o.transformStyles),onClick:o.onClick},{default:x((()=>[v(t.$slots,"default")])),_:3},8,["animation","class","style","onClick"])),[[T,a.isShow]])}]]);const it=st({name:"uniPopup",components:{keypress:{name:"Keypress",props:{disable:{type:Boolean,default:!1}},mounted(){const t={esc:["Esc","Escape"],tab:"Tab",enter:"Enter",space:[" ","Spacebar"],up:["Up","ArrowUp"],left:["Left","ArrowLeft"],right:["Right","ArrowRight"],down:["Down","ArrowDown"],delete:["Backspace","Delete","Del"]};document.addEventListener("keyup",(s=>{if(this.disable)return;const e=Object.keys(t).find((e=>{const i=s.key,a=t[e];return a===i||Array.isArray(a)&&a.includes(i)}));e&&setTimeout((()=>{this.$emit(e,{})}),0)}))},render:()=>{}}},emits:["change","maskClick"],props:{animation:{type:Boolean,default:!0},type:{type:String,default:"center"},isMaskClick:{type:Boolean,default:null},maskClick:{type:Boolean,default:null},backgroundColor:{type:String,default:"none"},safeArea:{type:Boolean,default:!0},maskBackgroundColor:{type:String,default:"rgba(0, 0, 0, 0.4)"}},watch:{type:{handler:function(t){this.config[t]&&this[this.config[t]](!0)},immediate:!0},isDesktop:{handler:function(t){this.config[t]&&this[this.config[this.type]](!0)},immediate:!0},maskClick:{handler:function(t){this.mkclick=t},immediate:!0},isMaskClick:{handler:function(t){this.mkclick=t},immediate:!0},showPopup(t){document.getElementsByTagName("body")[0].style.overflow=t?"hidden":"visible"}},data:()=>({duration:300,ani:[],showPopup:!1,showTrans:!1,popupWidth:0,popupHeight:0,config:{top:"top",bottom:"bottom",center:"center",left:"left",right:"right",message:"top",dialog:"center",share:"bottom"},maskClass:{position:"fixed",bottom:0,top:0,left:0,right:0,backgroundColor:"rgba(0, 0, 0, 0.4)"},transClass:{position:"fixed",left:0,right:0},maskShow:!0,mkclick:!0,popupstyle:"top"}),computed:{isDesktop(){return this.popupWidth>=500&&this.popupHeight>=500},bg(){return""===this.backgroundColor||"none"===this.backgroundColor?"transparent":this.backgroundColor}},mounted(){(()=>{const{windowWidth:t,windowHeight:s,windowTop:e,safeArea:i,screenHeight:a,safeAreaInsets:o}=B();this.popupWidth=t,this.popupHeight=s+(e||0),i&&this.safeArea?this.safeAreaInsets=o.bottom:this.safeAreaInsets=0})()},unmounted(){this.setH5Visible()},created(){null===this.isMaskClick&&null===this.maskClick?this.mkclick=!0:this.mkclick=null!==this.isMaskClick?this.isMaskClick:this.maskClick,this.animation?this.duration=300:this.duration=0,this.messageChild=null,this.clearPropagation=!1,this.maskClass.backgroundColor=this.maskBackgroundColor},methods:{setH5Visible(){document.getElementsByTagName("body")[0].style.overflow="visible"},closeMask(){this.maskShow=!1},disableMask(){this.mkclick=!1},clear(t){t.stopPropagation(),this.clearPropagation=!0},open(t){if(this.showPopup)return;t&&-1!==["top","center","bottom","left","right","message","dialog","share"].indexOf(t)||(t=this.type),this.config[t]?(this[this.config[t]](),this.$emit("change",{show:!0,type:t})):console.error("缺少类型：",t)},close(t){this.showTrans=!1,this.$emit("change",{show:!1,type:this.type}),clearTimeout(this.timer),this.timer=setTimeout((()=>{this.showPopup=!1}),300)},touchstart(){this.clearPropagation=!1},onTap(){this.clearPropagation?this.clearPropagation=!1:(this.$emit("maskClick"),this.mkclick&&this.close())},top(t){this.popupstyle=this.isDesktop?"fixforpc-top":"top",this.ani=["slide-top"],this.transClass={position:"fixed",left:0,right:0,backgroundColor:this.bg},t||(this.showPopup=!0,this.showTrans=!0,this.$nextTick((()=>{this.messageChild&&"message"===this.type&&this.messageChild.timerClose()})))},bottom(t){this.popupstyle="bottom",this.ani=["slide-bottom"],this.transClass={position:"fixed",left:0,right:0,bottom:0,paddingBottom:this.safeAreaInsets+"px",backgroundColor:this.bg},t||(this.showPopup=!0,this.showTrans=!0)},center(t){this.popupstyle="center",this.ani=["zoom-out","fade"],this.transClass={position:"fixed",display:"flex",flexDirection:"column",bottom:0,left:0,right:0,top:0,justifyContent:"center",alignItems:"center"},t||(this.showPopup=!0,this.showTrans=!0)},left(t){this.popupstyle="left",this.ani=["slide-left"],this.transClass={position:"fixed",left:0,bottom:0,top:0,backgroundColor:this.bg,display:"flex",flexDirection:"column"},t||(this.showPopup=!0,this.showTrans=!0)},right(t){this.popupstyle="right",this.ani=["slide-right"],this.transClass={position:"fixed",bottom:0,right:0,top:0,backgroundColor:this.bg,display:"flex",flexDirection:"column"},t||(this.showPopup=!0,this.showTrans=!0)}}},[["render",function(t,s,e,i,a,o){const n=(r=E("uni-transition"),l=et,p(r)?l:r);var r,l;const h=P,c=D("keypress");return a.showPopup?($(),S(h,{key:0,class:A(["uni-popup",[a.popupstyle,o.isDesktop?"fixforpc-z-index":""]])},{default:x((()=>[O(h,{onTouchstart:o.touchstart},{default:x((()=>[a.maskShow?($(),S(n,{key:"1",name:"mask","mode-class":"fade",styles:a.maskClass,duration:a.duration,show:a.showTrans,onClick:o.onTap},null,8,["styles","duration","show","onClick"])):I("v-if",!0),O(n,{key:"2","mode-class":a.ani,name:"content",styles:a.transClass,duration:a.duration,show:a.showTrans,onClick:o.onTap},{default:x((()=>[O(h,{class:A(["uni-popup__wrapper",[a.popupstyle]]),style:_({backgroundColor:o.bg}),onClick:o.clear},{default:x((()=>[v(t.$slots,"default",{},void 0,!0)])),_:3},8,["style","class","onClick"])])),_:3},8,["mode-class","styles","duration","show","onClick"])])),_:3},8,["onTouchstart"]),a.maskShow?($(),S(c,{key:0,onEsc:o.onTap},null,8,["onEsc"])):I("v-if",!0)])),_:3},8,["class"])):I("v-if",!0)}],["__scopeId","data-v-221fc41c"]]);export{R as P,st as _,q as a,G as b,K as c,N as d,z as e,H as f,U as g,Y as h,M as i,X as o,J as s,it as u};
